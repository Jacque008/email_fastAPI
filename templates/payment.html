<!DOCTYPE html>
<html >

<head>
  <meta charset="UTF-8">
  <title>Betalningsmatchning</title>
  <link href='https://fonts.googleapis.com/css?family=Pacifico' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Arimo' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Hind:300' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/static/css/style.css"> 
  
</head>

<body>
    <div class="ban">
      <h3>{{ title or "Betalningsmatchning" }}</h3>
      <form class="float-title" method="POST" enctype="multipart/form-data">
        
        <label for="id">Betalnings-ID:</label>
        <input type="number" id="id" name="id" placeholder="Ange betalnings-ID" value="{{ id or '' }}" required><br><br>
        
        <label for="amount">Belopp:</label>
        <input type="number" step="0.01" id="amount" name="amount" placeholder="Ange belopp" value="{{ amount or '' }}" required><br><br>
        
        <label for="reference">Referens:</label>
        <input type="text" id="reference" name="reference" placeholder="Ange referens" value="{{ reference or '' }}" required><br><br>
        
        <label for="info">Information:</label>
        <textarea id="info" name="info" placeholder="Ange ytterligare information" rows="4">{{ info or '' }}</textarea><br><br>
        
        <label for="bankName">Banknamn:</label>
        <input type="text" id="bankName" name="bankName" placeholder="Ange banknamn" value="{{ bankName or '' }}" required><br><br>
        
        <label for="createdAt">Skapad datum (YYYY-MM-DD HH:MM:SS):</label>
        <input type="text" id="createdAt" name="createdAt" placeholder="2024-01-01 12:00:00" value="{{ createdAt or '' }}" required><br><br>
        
        <input type="submit" value="Matcha betalning">
        
      </form>
    </div>

    {% if error %}
    <div class="result">
        <div class="container">
            <h2><b>Felmeddelande</b>:</h2>
            <hr>
            <p class="nocontent">{{ error }}</p>
        </div>
    </div>
    {% endif %}

    {% if results %}
    <div class="result">
        <div class="container">
            <h2><b>Matchningsresultat</b></h2>
            <hr>
            {% for result in results %}
            <div style="background-color: #f5f5f5; padding: 20px; margin: 10px 0; border-radius: 5px; border-left: 4px solid #007bff;">
                <h3><b>Betalning ID:</b> {{ result.id }}</h3>
                
                <div style="margin: 10px 0;">
                    <h4 style="color: #7A7A7A">----Betalningsinformation------</h4>
                    <p><b>Referens:</b> {{ result.reference }}</p>
                    <p><b>Banknamn:</b> {{ result.bankName }}</p>
                    <p><b>Belopp:</b> {{ result.amount }}</p>
                    <p><b>Information:</b> {{ result.info[:200] }}{% if result.info|length > 200 %}...{% endif %}</p>
                    <p><b>Skapad:</b> {{ result.createdAt }}</p>
                </div>
                
                <div style="margin: 10px 0;">
                    <h4 style="color: #7A7A7A">----Matchningsinformation------</h4>
                    <p><b>Matchade försäkringsfall:</b> {{ result.insuranceCaseId | join(', ') if result.insuranceCaseId else 'Inga' }}</p>
                    <p><b>Status:</b></p>
                    <div style="background-color: white; padding: 10px; border: 1px solid #ddd; border-radius: 3px; margin: 5px 0;">
                        {{ result.status | safe }}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    {% if not results and not error %}
    <div class="result">
        <div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div>
    </div>
    {% endif %}
    
    <a href="/dashboard" class="back-button">⬅️ Dashboard</a> 
</body>
</html>